<?xml version="1.0"?>
<robot name="pan_tilt" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:property name="M_PI" value="3.1415926535897931" />

  <property name="h1" value="0.027" /> 
  <property name="h2" value="0.021" />
  <property name="h3" value="0.033" /> 
  <property name="a1" value="0.013" /> 
  
  <xacro:property name="j1_mechanical_reduction" value="1.0"/>
  <xacro:property name="j1_motor_torque_constant" value="50.0"/>
  <xacro:property name="j2_mechanical_reduction" value="1.0"/>
  <xacro:property name="j2_motor_torque_constant" value="50.0"/>

  <xacro:property name="j1_lower_limit" value="-3.13"/> 
  <xacro:property name="j1_upper_limit" value="3.13"/> 
  <xacro:property name="j2_lower_limit" value="-1.5708"/> 
  <xacro:property name="j2_upper_limit" value="1.5708"/> 
  
  <xacro:property name="joint_effort_limit" value="2.0"/>
  <xacro:property name="joint_velocity_limit" value="2.9217"/>	
  <xacro:property name="joint_damping" value="0.7"/>
  <xacro:property name="joint_friction" value="0.5"/>

  <xacro:macro name="pan_tilt" params="name parent *origin hq">
  
  <!-- BASE LINK -->
	<!-- base_link -->
	<link name="${name}_link_base">
		<inertial>
		  <mass value="0.050" />
		  <origin xyz="0 0 0" />
		  <inertia  ixx="0.0001" ixy="0.0"  ixz="0.0" iyy="0.0001" iyx="0.0"  iyz="0.0" izz="0.0001" />
		</inertial>
		<visual>
		   <origin xyz="0 0 0" rpy="0 0 0" />
		   <xacro:if value="${hq}">
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/base_pan_tilt.dae"/>			 
		   </geometry>		   
		   </xacro:if>
		   <xacro:unless value="${hq}">
		   <geometry>
			  <mesh filename="package://summit_xl_description/meshes/pan_tilt/base_pan_tilt.dae"/>			 
		   </geometry>
		   </xacro:unless>
		   <material name="carbon_fiber">
              <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
           </material>		   
		</visual>  
		<collision>
		   <origin xyz="0 0 0" rpy="0 0 0 " />
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/base_pan_tilt.dae"/>			 
		   </geometry>
		</collision>
	</link>

	<joint name="joint_${name}_base" type="fixed">
	  <insert_block name="origin"/>
      <parent link="${parent}"/>
      <child link="${name}_link_base"/>
      <origin xyz="0.0 0 0.0" rpy="0 0 0" />
    </joint>
    
    <!-- LINK S1 Fixed -->
	<link name="${name}_link_s1">
		<inertial>
		  <mass value="0.050" />
		  <origin xyz="0 0 0" />
		  <inertia  ixx="0.0001" ixy="0.0"  ixz="0.0" iyy="0.0001" iyx="0.0"  iyz="0.0" izz="0.0001" />
		</inertial>
		<visual>
		   <origin xyz="0 0 0" rpy="0 0 0" />
		   <xacro:if value="${hq}">
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/rx-28.dae"/>			 
		   </geometry>		   
		   </xacro:if>
		   <xacro:unless value="${hq}">
		   <geometry>
			  <mesh filename="package://summit_xl_description/meshes/pan_tilt/rx-28.dae"/>			 
		   </geometry>
		   </xacro:unless>
		   <material name="carbon_fiber">
              <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
           </material>		   
		</visual>  
		<collision>
		   <origin xyz="0 0 0" rpy="0 0 0 " />
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/rx-28.dae"/>			 
		   </geometry>
		</collision>
	</link>
	
	<joint name="joint_${name}_s1" type="fixed">
      <parent link="${name}_link_base"/>
      <child link="${name}_link_s1"/>
      <origin xyz="0.013 0 0.027" rpy="0 0 0" />
    </joint>
    
	<link name="${name}_link_1">
		<inertial>
		  <mass value="0.050" />
		  <origin xyz="0 0 0" />
		  <inertia  ixx="0.0001" ixy="0.0"  ixz="0.0" iyy="0.0001" iyx="0.0"  iyz="0.0" izz="0.0001" />
		</inertial>
		<visual>
		   <origin xyz="0 0 0" rpy="0 0 0" />
		   <xacro:if value="${hq}">
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/fr07-s101.dae"/>			 
		   </geometry>		   
		   </xacro:if>
		   <xacro:unless value="${hq}">
		   <geometry>
			  <mesh filename="package://summit_xl_description/meshes/pan_tilt/fr07-s101.dae"/>			 
		   </geometry>
		   </xacro:unless>
		   <material name="aluminium">
              <color rgba="0.678431373 0.698039216 0.741176471 1" />
           </material>		   
		</visual>  
		<collision>
		   <origin xyz="0 0 0" rpy="0 0 0 " />
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/fr07-s101.dae"/>			 
		   </geometry>
		</collision>
	</link>

	<joint
		name="${name}_joint_1"
		type="revolute">
		<origin
			xyz="0.013 0 0.048"
			rpy="0.0 0.0 0.0" />
		<parent link="${name}_link_base" />	
		<child link="${name}_link_1" />
		<axis xyz="0 0 -1" />
		<limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${j1_upper_limit}" lower="${j1_lower_limit}"/>
		<dynamics damping="${joint_damping}" friction="${joint_friction}"/>
	</joint>


    <transmission name="j1_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="${name}_joint_1">
        <hardwareInterface>EffortJointInterface</hardwareInterface>
     </joint>     
     <actuator name="j1_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j1_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j1_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>


    <!-- LINK S2 Fixed -->
	<link name="${name}_link_s2">
		<inertial>
		  <mass value="0.050" />
		  <origin xyz="0 0 0" />
		  <inertia  ixx="0.0001" ixy="0.0"  ixz="0.0" iyy="0.0001" iyx="0.0"  iyz="0.0" izz="0.0001" />
		</inertial>
		<visual>
		   <origin xyz="0 0 0" rpy="0 0 0" />
		   <xacro:if value="${hq}">
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/rx-28.dae"/>			 
		   </geometry>		   
		   </xacro:if>
		   <xacro:unless value="${hq}">
		   <geometry>
			  <mesh filename="package://summit_xl_description/meshes/pan_tilt/rx-28.dae"/>			 
		   </geometry>
		   </xacro:unless>
		   <material name="carbon_fiber">
              <color rgba="0.792156862745098 0.819607843137255 0.933333333333333 1" />
           </material>		   
		</visual>  
		<collision>
		   <origin xyz="0 0 0" rpy="0 0 0 " />
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/rx-28.dae"/>			 
		   </geometry>
		</collision>
	</link>
	
	<joint name="joint_${name}_s2" type="fixed">
      <parent link="${name}_link_1"/>
      <child link="${name}_link_s2"/>
      <origin xyz="0 0 0.042" rpy="0 -1.5708 1.5708" />
    </joint>


	<link name="${name}_link_2">
		<inertial>
		  <mass value="0.050" />
		  <origin xyz="0 0 0" />
		  <inertia  ixx="0.0001" ixy="0.0"  ixz="0.0" iyy="0.0001" iyx="0.0"  iyz="0.0" izz="0.0001" />
		</inertial>
		<visual>
		   <origin xyz="0 0 0" rpy="0 0 0" />
		   <xacro:if value="${hq}">
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/fr07-h101.dae"/>			 
		   </geometry>		   
		   </xacro:if>
		   <xacro:unless value="${hq}">
		   <geometry>
			  <mesh filename="package://summit_xl_description/meshes/pan_tilt/fr07-h101.dae"/>			 
		   </geometry>
		   </xacro:unless>
		   <material name="aluminium">
              <color rgba="0.678431373 0.698039216 0.741176471 1" />
           </material>		   
		</visual>  
		<collision>
		   <origin xyz="0 0 0" rpy="0 0 0 " />
		   <geometry>
			 <mesh filename="package://summit_xl_description/meshes/pan_tilt/fr07-h101.dae"/>			 
		   </geometry>
		</collision>
	</link>

	<joint
		name="${name}_joint_2"
		type="revolute">
		<origin
			xyz="0.0 0 0.042"
			rpy="0.0 0.0 0.0" />
		<parent link="${name}_link_1" />	
		<child link="${name}_link_2" />
		<axis xyz="0 1 0" />
		<limit effort="${joint_effort_limit}" velocity="${joint_velocity_limit}" upper="${j2_upper_limit}" lower="${j2_lower_limit}"/>
		<dynamics damping="${joint_damping}" friction="${joint_friction}"/>
	</joint>


    <transmission name="j2_trans">
	 <type>transmission_interface/SimpleTransmission</type>
     <joint name="${name}_joint_2">
        <hardwareInterface>EffortJointInterface</hardwareInterface>
     </joint>     
     <actuator name="j2_motor">
	    <hardwareInterface>EffortJointInterface</hardwareInterface>
        <mechanicalReduction>${j2_mechanical_reduction}</mechanicalReduction>
		<motorTorqueConstant>${j2_motor_torque_constant}</motorTorqueConstant>
	 </actuator>	 
    </transmission>
      
  </xacro:macro>

</robot>
